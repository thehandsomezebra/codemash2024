
... Back to [[index]] ...

[[Writing Secure APIs - A Look at the OWASP 2023 API Top 10 List]]



```
Speaker 1   00:00
So, go ahead and get started. Thank you guys for getting out and coming to the early talk. I like to shape that, I know, it's always easy. Um today we're going to talk about writing secure apis. For the source for this, I'm using a wasp's top 10 apis Securities. A list and this was published back in July, so it's not super old. Um, but It has some really good stuff that we can talk about. So my name is Carolyn Ross, I work for cover my vets, I'm an application security engineer there. Um, I have You know what? Give me one second. I realize I don't have my notes. Oh, it's got my my windows. Where is that? That is on top of the Beehive Trail. Where's that? And it's in Acadia National Park. It was a very cool thing. And I'm trying. There we go. That's what I need. Sorry about that. I just realized I'm like, wait a minute, my nose right here. So, I've been in I.T for about 34 years. The first 24 of that, I was a developer Um, the last 10 I've been working in security and focused mostly on application security. Um, please don't hold your questions. I would much rather get your questions in context. I've had it a little bit of time in there for a question. So, I really do prefer discussion. Go ahead and raise your hand. If I don't see you call out my name or hey, you whatever, Because I really don't want you to leave here with a question that we could have discussed Okay, so let's get into it. Our topics. Today we're going to talk about some Security awareness around, apis. We're going to then go through the top 10 and we're going to then do a little bit of discussion on how we use this. So first thing is awareness. Um, everybody's got a story and you know, what this conference is like the perfect example of that because you sit down at a table where you don't know anybody to eat lunch and you start talking and everybody's got a story, right? Depending on the topic. So these are a few stories around ACT ranges that have happened in the last few years. It's hard to get super up to date. Uh, stories about preaches because a lot of times companies don't disclose things or don't disclose them for a while. We have some new laws that are going to maybe help a little bit with that but you still don't need to give a lot of detail to the public. But these are three that. Involved, API, vulnerabilities, or issues. So, first of all, November 2022, T-Mobile T-Mobile's had a lot of security issues over the last few years. This was just one of them, they had an attacker abuse, a single API, 37 million customers were impacted, and they paid 500 million in fines and settlements. So that's not even the full financial impact right there. There are other Financial things that are gonna happen with their brand and and other informations. But that's the number that's public. Office Telecom another Telecom. I used to work in Telecom, so they're easy. Pickings for me. Right Australia. Uh, September 2022 publicly exposed an endpoint and had no authentication on it. Okay, so it's just out there for everyone to hit, um, and then to make it even easier for the attackers. They knew sequential ideas on their data. So you put a new brand, it's really easy. 10 million customers data was impacted and 140 million. I don't know whether that's fines or settlements or really how that 140 million is broken down. That was just that, that was the financial impact listed. So it could be even more than that if there were settlements that weren't disclosed Um, and then Twitter, I'm always going to call it Twitter, no matter what they decide to call themselves. Uh, July 2022. So, their API allowed attackers to query your account by just using your email or your phone number. So they can get your account data, they have your email called this HDI a bit. That one we have 5.4 million accounts impacted and they had 250 million in mines. So you can see not only is the impact to our users data, but our company is having to pay a lot of money and fines if we have one of these situations So, um, The next everybody's got a story. This is this data is from traceable. I don't use traceable. I'm not customer of theirs. I've never even done other product, but they had some nice stats. So, I went ahead and took those and just to comment on API security products because they are an API security product. I have not seen any API security product that really Wows me. I to be fair, I have not loved him about the last 12 months. But uh, a lot of them are just being developed very immature. Very difficult to implement, right? So, The stuff we're going to talk about this morning. I I'm not sure that there's a tooling solution yet. There might be a tooling solution in the future. It's coming but not yet, I think, today, our biggest way to combat this is through educating development folks. Right. Educating our Engineers because um We don't have the tools yet to really help us. So these stats, 60 organization organizations have faced an API related reach in the last few years. Um, 57 are talking about uh they can't distinguish fraudulent from genuine API Timmy. I would really like to talk to the other 43 percent of those people. Because I bet they can't either and they just don't realize it. Okay, I'm skeptical. I think that number is low and then the last one here, The the number I really like in here is 127 third-party API connections on average. That's a whole lot of Connections to keep track of. So you might be smaller and not have that many, you might be bigger and have more, but that's a lot of inventory to manage for third-party connections. That's just, that's not your own internal stuff. That's the stuff out there. You're dealing with Okay. So let's talk for a minute about why we like apis and what's important to different groups of folks in it. So, For my development folks. Why do you like apis? Any any comments?

Speaker 2   07:46
You

Speaker 1   07:50
Are my people. Yeah. What else? Anyone else have a five? So easy to get the data. It's awesome, right? Very predictable. Yeah, you have a request, you have a response. You know what it's going to be? It's beautiful. Yeah, definitely. We love automation. We love doing that with our testing Okay, you guys hit a lot of mine. They're also very efficient, right? You can write some really elegant efficient. Hope. Thank you, guys. Um, And a lot of times they help us fairly easily, meet requirements, this kind of goes to the UI stuff in my head. Is if I have some requirements, I can usually map those out in an API really nicely That's just how I think, right? All right, so product owners. Um, product owners really run our lives, right? Or the business as sometimes, uh, we call it. So, what do they like about APIs? Well, again, they like all that data that can get because they love data, the more data they have the better business decisions they can make right. They love that we can integrate easily with Partners. I kind of blame them for those 127. External apis. Because they really love the immigration and sometimes that immigration means money for your company, right? We integrate in that generates profits. And then they also look the speed of delivery that we like those apis. They like it that we like it because we can grow it faster. Okay. How about Security Engineers? Um, Well, I'll tell you, I I feel like And my heart of hearts, I'm a developer, but I'm a security engineer. Now, this is the role I play. So I like all the things you guys said. But my problem is the level of risk. We introduce sometimes with apis is a little scary, right? We always aren't thinking about risk when we're dealing with B's and we need to do that a little better. And then why would attack her type apis? Ah well all of that data so easily. Accessed the same reason, we like to deal with it, they like to deal with it. They can get a hold of an API that gets them. A lot of data. That makes their day, right? The speed of Expo exfiltration, once they get it, once they figure out how to get it, they can get it out of your system fast, right? We usually do a horrible job of logging monitoring and alerting our apis. And so they know that they know they may be able to pull all this data and nobody's going to know it. There's not going to be an alert set off. Nobody's going to see anything in their lungs. It's beautiful for them. Um, it's really easy for them to Recon and research because they don't always have to be on the inside. They can Recon and map apis externally. So, we've given them a new way to look at our insights, right? Um and then we're really bad about authentication and authorization with our apis. So that even makes it better for them because if we don't pay a lot of attention to that authorization, Um, they can get to places where normally they would never be able to get Okay. So one more awareness slide I promise then I'll stop harping. Uh, Why are apis insecure? Well, first of all, We don't do a great job with security and design. Uh, we need to start thinking about security when we're we're at the very beginning of this, whether I don't care what methodology you're using. I know agile doesn't have a technically designed phase but you're still doing design, right? You're doing design in that process and we're not thinking about security when we do that. Okay, so that's definitely an awareness issue. Um, easy access again. Like I was just talking about, we leave the front door, open, come on. In are also, authentication is weak so we don't even ask you, your name just come on in. See everything I have, right. We have a giant inventory. Not just of those external apis, we have a giant inventory internally. I went to the graphql session yesterday, and he was talking about, you know, well, so and so, what's this feature? So we'll just write a new endpoint for them. And so, and so what's this feature? And we'll write a new impact for them. Joining inventory. And we don't always have a great way to keep track of that. And that causes our apis to be insecure because we can't really figure out what we have or where our sensitive data is. Um, we have weak security testing. I feel like these days are functional. Testing is getting better and better, right? But we're still so behind on our security testing we don't prioritize it. Our companies don't prioritize it and even our security teams. We're like, huh? What are we going to do about that? We're still trying to do this other basic stuff, right? So our security testing is anemic. Um, Oh zombie apis. So we're like yes we can get rid of this API, nobody's going to use it anymore. It's bad. It has all this bad stuff. Let's kill it. We're not going to use it zero traffic yes but then we don't actually kill it. So, we killed it, but it's still alive and it's still there that somebody could find, especially if it's externally exposed. And it could be abused, it could be an attacker if they find it, figure out how to use it. There we go. And we're not paying any attention to it because it's dead to us. The same rain Shadow apis. If somebody's writing an API under the table, maybe this is a non uh non-it group. Sometimes you'll have business groups that have some technical people that like to do some things and set up their own I.T stuff without us, knowing it and boom. You now have access to our company's data through that shadow again. And then the last one is we are so so purpose. We're bladder mouths. Right? We send tons of data back. Oh, you want you want these three Fields? I'm going to give you 30 Because you know I'm nice and you might need it someday and here's some sensitive data for you, right? So we're way too verbose and we don't pay attention to what data we're giving people on our apis. Um, so like I said before, developers are number one defense around API security. The tooling is going to get there, right? It's going to get More and more mature, where I have told him that I can come to you and say, hey we've got a problem with this API but I I really don't think our industry is there yet. We're getting closer. So enter the oasp API, top 10 security risk list, right? This is a broad consensus about the most critical security risk to apis. It was released in July 2023. And we're going to talk about this for the majority of our time today. So I'm gonna go plugged, oh, so they were kind enough to give me this list of things that I could talk about. So I didn't have to go create my own list, owasp is a great organization. I don't know how much you've paid attention to them. I know you probably have to do some secure code training. On the owas top 10 every year and you're just like, seriously, seriously. There's a reason it's a really good list and it really is there's a lot of reasons that goes into that. They underscore potential risks in our web apps and our apis. They have a mobile top 10, some just super good information. They also provide mitigation strategies, best practices cheat sheets, those kind of things, Google it. It's a great repository of information and resources, for us. I was started in 2004 in the U.S, so they've been around about 20 years. Their community-led, they're open source and I think they're a great success story for open source, right? Lots and lots of people have contributed and work very diligently, give their time to owe us. They have over 250, local chapters and tens of thousands of members so commercial over. I just felt like they supplied so much information for me for this talk. I wanted to make sure to call it out and evangelize or owas So let's get into this list. Now um, the first thing you're going to notice, when you look at this slide is I don't have a number four. That's because OS numbers their top 10 list by severity and how much this is happening. So number one, is the number one biggest thing that is happening out there. That's a problem. I'm going to attack it a little differently. We're going to attack this functionally so I'm not going to go in one to ten order. So I didn't forget number four. What we're going to talk about, first of all is authentication. And authorization. You can see five of the ten of oasilis center around authentication and authorization, it's a problem, right? Half of half of the things that oasp was calling out. And these are attacks on confidentiality. Confidentiality is keeping my stuff private, right? The things that I don't want you to see, you shouldn't be able to see So, these are all attacks where the attacker is trying to find out information or data that they shouldn't be allowed to see. It shouldn't be allowed to read. They shouldn't be allowed to do anything with. Okay. Um, let's define authentication and authorization really quickly. Um, so authentication, it's basically me proving to you that I am who I say I am So my name is Daryl Lynn, Ross. You know. Here's my address whatever. Here's my thumb print. Here's my password. Here's my I scan. Here's my code from my authenticator app. Um here's my IP address, those kind of things that's me proving that I am how I say I am. And then authorization is once, you know, that really mean, what am I allowed to do? So, who am I? What am I allowed to do? Um, Let's see, number two is going to be around authentication. Number one, three and five, authorization. And then number six is a combo of those. So here we go. Broken authentication. Um, this is one of hackers can obtain data about me. And they can assume my identity. So we've all had to do fishing. Pests we've all clicked the links. And we all have to pay a lot of attention to that because our identities are very valuable, right? We're not the average. Joe. Our identities are super valuable to attackers. Um, sometimes attackers can get some of my information from data breaches at other companies. Uh there are plenty of lists out there of emails and IDs and passwords and things like that and sometimes they can get it through reconnaissance. So, uh, if we're leaking information, authentication information, sometimes an attacker can get some data that way. But what happens then is, They are able to access a system as me or as a user and Then we can't tell like I do a lot of threat modeling with our, uh, Development teams and unspoofing. The question is, how would we know this and 99 of the time as we wouldn't, we can't tell the difference. You've got my authentication stuff so you can pretend, you're me sure. Um, We sometimes lose don't have Miss Brute, Force controls. We leak authentication details. We have weak authentication standards like here. Come on in. We don't need to know who you are. Um, We sometimes have poor validation. And then weak encryption for when we store that, that identity data, okay? Um, And from an API perspective, if you're able to get enough info, Uh, if they're able to get enough info, we just assume they're legitimate. It's okay. What else can we do, right? So, some things we can do to prevent broken authentication. Um, First of all, and this is, especially if you inherit an API, you write the API, you're going to know your office flows pretty well. But if you inherit it, you have to go look and see. You know, what are the different ways? Somebody's going to access this. There might be a difference between web and mobile. There might be deep links. There might be some emailing with a link that goes out that then somehow accesses this. Um and you may totally miss it, whoever turn it over to you. If somebody actually turned it over you, maybe didn't tell you about that part. Right. Um, So definitely try to understand know your program off flows know how those mechanisms work. There was a great talk yesterday. About awesome. And Authorization authentication, authorization and we were talking about how oauth isn't really. An authorization mechanism, right? It's a delegation mechanism. It's great talk. So know how your awesome mechanisms work and what they are, right? Um, No treat. Recovery implants like login so recover end points are I forgot my password, help me figure it out. I forgot my user ID, those kinds of things you have to treat those just like login don't give an attack or a pass because you know they're gonna try it right. They're gonna try all those. Make sure you're securing that Require real for sensor operations. This is I'm changing the owner of the account's email address. Well, let's have some additional work around that right to make sure they really are, who they say they are. I'm going to change the number for the two-factor authentication. The you know, the the phone number on the two-factor authentication, make them prove themselves before you let them do that and then Implement account lockout controls. Um, Just help with riptors. So how many times are they allowed to try to sign in with this ID? Before you say? Oh, we need to take a 15-minute break here. And sometimes your business is going to say, whoa, whoa, whoa, we need them to sign in. Don't don't restrict them and that's a risk that they have to consider. As a security person I'm going to always recommend it as a as a product or business person. I might get some pushback and I might lose that fight, but it's a conversation at least to have Okay. Use multi-factor off when possible. I know it's not perfect. I know multi-factor off. You can. Can be. Packed. But you know what? In most cases, it's better than not having it okay. Um, don't use API keys for user authentication. Okay, this is some of what we talked about yesterday in that ol session uh API Keys. They identify a calling project and they may be something that you consider as secret, right? But they are not authentication, they aren't proving that I am. Who I say I am Okay, I need an authentication. Token to do that. And there is a difference. Okay, we're not going to dive super deep into it, but Just realize that API keys are not the answer to authentication. Um, we're

Speaker 2   25:31
Saying basically using for authorization.

Speaker 1   25:34
Um like

Speaker 2   25:35
This key is was authorized to get this data. Like is or you have to, you want every API call to have both authentication and authorization.

Speaker 1   25:44
Yeah. And you know what? The aps are there to help you identify some of who's calling you but they're really not an effective method for True authentication or authorization. All right. And again we tend to be weak on that. Okay. Um, Use anti-brute force or credential stuffing controls again. This is like rate limiting when I worked at Chipotle. We had huge bunch of stuffing issues like just continuous And we actually have vendor, we hired uh there at that time they were called shape, if F5 bought them so I think F5 has renamed them But they would, um, Look at signals in our traffic, they did some very deep analysis, on our traffic to try to help us with some of this brute forcing. So that's like the Using a vendor to help but depending on how much you're being attacked in that area, Um, and this is going to be What you can put in your code, right? So, you can put written in your code, but it's also going to be something, your security team works on some help with maybe a WAFF, a wasp, something like that. Trying to identify that traffic. Um, use strong encryption controls. This is going to be with your dvas, they're going to help you here. They're going to want to protect that data just as much as you do. And I do and then, uh, there's a really great a loss authentication, cheat sheet, has a lot of really good information. Yes, but

Speaker 2   27:23
For the first item use multi-factor off when possible. Which authentication are we talking about there? Because obviously the system, the system API College. You can't really factor off there. Yeah.

Speaker 1   27:34
Um, and really, if I have my choice with Apex, I'm going to want to do Mutual offs. You know, certificates the whole thing. But if you can have, if you have something, if you have like, you have to access a system and then this is going to kick off some API. You know, if you have some of the user interface like that it's still I know it's not your API but it's getting to your API. We want to have layers of Defense defense and jobs so that's really where that's centered. Any other questions?

Speaker 2   28:08
It's a later topic. Um, maybe that all says or not, but if you're already Vape, guys out that the third parties are using to get to your system. How do you update Your authentication, protocols without killing people. It's

Speaker 1   28:20
A really hard thing. I have that problem where I work, I work for program, Finance, and we integrate with ehrs. You know what, they're handling, the authentication on their side and and we had a pen test result um in one of our apps said you need stronger more, like it's contractual we can't do anything about it. So there are sometimes when you're stuck so in that situation I might say I went a little extra login and monitoring and learn And that API for, I want to make sure we have a decent limit set on rate limiting, you know, those concerns because I don't get to control that Um, let's see next. Oh, we're going to talk about authorization. So there are three kinds of authorization that are called out in the top 10 list object, level object, property level object, function level, Okay, so Um, we're just going to talk about these on the same slide, just one at a time. So first of all, is object level. Um this is where we really need to validate that the user has permissions to perform whatever action, they're trying to form on an object. Okay. Um, this could be where an attacker changes input to request data from a different object that they, they're not authorized to see and we let them do it. So, some of this is we've added all these endpoints, right? And whenever some of these have sensitive data, and they shouldn't really be allowed to see that data. But because we've just added on and added on, they can And trust me, attackers are going to do everything. They can to try to enumerate and figure out everything they can get to. And then figure out what they can get from everything they can get to. Okay. Um, Next is going to be property level, so Uh, If we have apis that allow you to Read or update read even delete properties of your object. If something like that going on, you have sensitive data that's involved. So if you change a property you can access sensitive data, maybe you can read sensitive data. You get some details out of that property. Um, we need to off the rise on that. Uh, on that column. And I know you're like, Come on, Caroline, I can't offer us at every single thing, right? But I'm talking about think about where you have sensitive data. Think where you have data that the attackers want for me. It's Phi, right? Where's my Phi? What apis are going to give you access to that point

Speaker 2   31:14
Phi?

Speaker 1   31:16
Sorry, personal health,

Speaker 2   31:17
Personal health, I

Speaker 1   31:18
Work, um, in a long electronic prior authorizations for prescriptions, so, I'm pretty sure I have your grandma's Health data and we protect it. We try, we try our best, okay? And then the last one is function level. So again a call to an endpoint, sometimes a user could try to like Elevate privilege from a regular user to an admin user. And then maybe they can do more with that function. Um, Maybe they can get to a different function. Uh, without really having to do much not fall. So these are all Ways that an attacker will try to. Change access mess around with request parameters. Those kind of things. And try to get past your authorization and and, uh, let's talk here. Here are some of the preventions we have for this so um, again used to write authorization mechanisms oauth open ID. Those things are not authorization mechanisms, okay? Um, Check access for your database actions. And again, it doesn't have to be Every single database action, I should change this slide to say every sensitive database action. Use random and unpredictable glutes. Remember the thing where I said, they made life easier for attackers by doing sequential IDs and their data. Just make it a little harder for him, you know, maybe they'll say that's too hard and go away, maybe they won't, but it's something we can do. Test your authorization functionality. This goes back to that week's security testing sometimes we'll test it for one role and say we're good. No test it for all the roles. Make sure we're really covering the admin super admin super user kind of stuff. Um, Deny access to sensitive data by default. This is something we don't always think about, but Deny the access by default, and then open it up in the cases where it needs to be opened. Don't just give the whole world that access And then, Inherit from. Um, admin offered Sorry you say it, right? Make sure that your administrative controllers inherit from an administrative abstract controller, right? This is just good, programming practice. Sometimes we get lazy. All right, the last one in this section is unrestricted access to sensitive business flows. So somebody might call this API misuse, I think it's abuse, right? An attacker doesn't misuse things. They abuse things. So A lot of times this is going to come with authorized access. So either this person is a legitimate user who is doing something malicious or they've spoofed they've fished, they figured out a way to be authorized and have that access. And then can take advantage of it. So you can have a perfectly designed API. You can have great security controls, right? If the attacker gets authorized access and this is a business flow. That they shouldn't be allowed to do something with. They can still cause lots of damage and it's and it's really how your NPI is designed. Um, security scanning tools won't help you. If you're maybe doing a threat model will help you identify that like oh shoot we shouldn't let just anybody do this? Right, but it is fairly hard to do to text. So, A lot of times, an attacker could exploit a vulnerability in this scenario, but they don't have to right? Uh, unsanctioned use unintended use. We just didn't think about them being able to use it this way. So a couple of things here on prevention, first of all, some of this lace with your, your product folks, your business folks. They are the ones that really know the business flow, the best. They have a better. Of probably the overall business flow. So, this is something that really needs to be detected in design when they're giving you requirements. When you're going through and grooming. Um, we need to figure it out there and call it out there. And then once it's figured out, you can put the right protection mechanism in communicate the problem, right? But you have to identify it. So, this one If I put it with authentication and authorization because really, we're probably not protecting a business level that we should protect. All right, intermission. This is my favorite meme ever. Um, Any questions at this point, I want to take a drink of water. Okay, okay. We'll move on. So next one is consumption forgery. These are going to be attacks on Integrity, Integrity and availability. So Integrity is going to be that. My data is accurate. And it can be trusted, right? I have nobody's tampered with it. Nobody is able to get in the tamper with their data, my code, my systems, anything like that, and then availability is that my users can get to the system they need. So this API is up and running. Um, Let's jump into server side request forgery. So, This is when an API is touching a remote resource without validating user supplied data. I'm telling you, if I could just put a tattoo on my forehead and I'm having no tattoos, but if I could put one on my forehead, I would just say validate user supply of data, right? It's it's just something that we need. We need to not trust our users because you really never know who they are. So in this scenario, we we get some kind of user supplied data. An attacker is able to craft that data to Direct. Processing. Okay. They can coerce a server-side application to make requests to an unintended location. Your WAFF and your VPN usually are going to help you on this. They might but probably not. So um here's where this can happen. Some of the external resources web hooks bio fetching. Um, URL preview. And then the last two here, Concepts today, really encourage us to use external resources, okay? And This is going to be. Uh, things like Cloud providers, kubernetes Docker. They expose some of the management and Control channels. Usually over HP sometimes very predictable. Well-known pass. If you've worked in it and attackers, trust me, attackers know this just as well as you do. Um, they can figure out where to go fairly easily. So um some of the kinds of attacks we see here, is the attacker might cause a server to make a connection to an internal only service. That you don't intend them to connect to, right? And then they can get into your infrastructure admin functions. Those kind of things, they might be able to force a server to connect to an external system. That you don't want to send your user to Um, They could leak sensitive data. Off credential something like that. And then um really what this is doing is exploiting, trust relationships. And, What if they can get to vulnerable application and do something there? Then you're in trouble. So I'm going to uh, just a minute here. We're going to talk about capital one, capital, one mortgage. So they have a fairly famous. Um, thank you, they had a fairly famous. Uh, breach in 2019, an attacker was able to obtain a credential probably through fishing, we're not sure how but probably, and they had a misconfigure on their ways. The attacker was able to recognize that when they were doing Recon. The trip to Target server into connecting to a system in AWS. Where it shouldn't have been able to connect. So they got into the AWS instance, when they shouldn't have been able to Um, And then they were able to get to the AWS metadata service. And, Retrieve all credentials for all of the things, all of the S3, buckets, all of the data and then They were able to get to 100 million customers worth of credit applications. Mortgage applications for 100 million customers and the fees around that were 270 million. Um, and I'm sure a lot of Brands damaged. There's a really nice write-up on Brian Krebs, crabs, and security blog around this breach goes into a lot more detail than I just said in the last few minutes. It's interesting, if you want to go read that, Okay, so for server side, request forestry things we're going to do, we're going to isolate resource fetching. Anytime we can, especially when you're dealing with remote resources, Internal. It's a little little different, but if you can isolate your remote resource hedging, that route disable, any HTTP redirect, It's 2024. I'm so sick with TLS, right? Um, I really am. Yeah, just yeah. I want that to secure Communications right validate client supplied data again back to on my forehead. If you're getting it from an unknown, sour Even uh if you trust him a little bit but don't completely trust them. And I don't trust. Uh, validate it. Just check it. Use allowless. I know this one is always annoying cuz you're like, I can't use a Lawless cuz I need, you know, to get input. That has a lot of different options. Well, maybe you can use a lettuce on media types, that's a good one. You're only allowed to give me, you know, PDFs or whatever. Um, So, sometimes you are all schemes. We can do this with remote Origins if you can, if it's pretty locked down, where something is coming from, use an allowance Okay. Um, URL cursor. Make sure that you're using something. That's well, tested and maintained. Now, use some open source thing that hasn't been touched in the last five years, right? You want to have a decent URL cursor and then um, don't send or our responses to clients. So, If you get some data from a third party, just don't just pass it on to your client. You need to go to check it, and make sure that it's valid Um, because you should be passing on something that could really hurt that concern. Okay. Um, next unrestricted resource consumption. I'm a farm girl. So I have to say here, piggy piggy, come get all the resources. So, uh, Places that we either have things set too high or too low. Timeouts spending limits on like Cloud resources. Too high too low. Both of those can be a problem. Um, Number of Records, any kind of Max values allowed memory processes file sizes, those kind of things. Um operations per request, any of that, what can happen is an attacker can take advantage. If you have that set too high, they may be able to do things and you don't know it. If you have it set too low They may be able to affect the availability of your systems, right? So we need to tune those properly. Um, And on the on this side, just how we fix these things. One option is containers or serverless that helps us limit resources, right? Um, We can set spending limits on some of those either Cloud resources Cloud processing or even other. You know, if we have it costs us so much to use a vendor API, you know? For every hundred thousand transactions. We pay so much money, whatever that might be. Make sure you have limits on that. So an attacker can't go and run that up. Server side validation is going to help here validate any of that client data limit single client number of use. Rate, limiting rate, limiting rate limiting It's a good thing, even if you have To set it pretty high. Like, you're like, this is a really busy API. I do a lot of work here, so it's rate, lending, worth it. Yes, it is figure out what your high water Mark is and set it higher. It will still help you. If an attacker is going after you there, that might trip that alert and and give you notice early, okay? Um, And then look at your payloads, make sure that you are not just accepting any size payload, right? Because an attacker is going to try to push that and see what they can do. Next, I'm saying apis, what friends should you trust? And then back to that 127. Who am I trusting? Who are you integrating with? And attackers are going to try to identify those kind of services and Target Target API Integrations. Um, they'll try to compromise them, they may be able to compromise your vendor to get to you. They may just be able to compromise that connection. So things to do here. Um, you need to assess your third party standards. You need to assess your friends. Make sure they're doing what they're supposed to do. Uh, validate and sanitize data from other apis. On my forehead. Allow. Uh, redirecting your eyes. Also, don't just blindly follow redirects inspect those some of the things we just talked about. On server side. You just tell us, you just tell us use TLS 1.2. Um, You skills. Limit resources that you allow third parties to access so resources in turn our system limit data, you send back to them only give them what they mean. Don't give them anything extra. I don't care if you think it would be nice for them. Don't don't do it right. Okay. Okay, the last cut these last two and I like to call this making life easier for attackers. Which I don't want to do, right? All right, so security misconfiguration. Um, you know what? Let's jump back here, just one second. Jump back here, these are tax on Integrity. These are things where attackers are going to try to do something to make our data wrong or bad or take advantage of What we have misconfiguration, we don't have things set up properly. So, securing this configuration we're just going to talk about how Often attackers are going to look for these kind of things. This is all part of the reconnaissance, right? And Let's just run through this list. You might be vulnerable. If your error messages can stain contain stack prices in production, okay, I know sometimes in law environments, that's really helpful for you and it's fine but in production, no, because it's really helpful for them. Okay, you have bonus features. This kind of goes back to your, um, to the zombie apis. If you kill a feature kill it, don't just let it sit there because your users may not use it anymore, but an attacker might find a really great way to use it. Okay? So it's kind of cleaning up after ourselves. I know that's hard to do. I know we off a lot of technical debt we deal with but it's important from a security purchase perspective. Um, if you don't use TLS, Enough said. If you aren't keeping up on patching. My co-worker. One of our other applications has a little sticker that he likes to hold up to the camera that says Pat, your shit patch, your shit. I I should have just borrowed the sticker from him and brought it. Um, your your cross origin resource, sharing policy is missing or properly set up. So of course Honestly I could kind of rather have it missing than a properly set up, because if it's improperly set up you think you're good but you're not. So, Take a look at those things. Make sure you have them properly set up. Uh, your clueless about configuring your Cloud. So I was developing when Cloud first got really sexy and fun and oh, everybody wants you in management, it's like, yeah, go do this. It's going to save us some money, you know, and all those things and they just threw us in. And we didn't know how to figure the cloud. Like we're all just like, oh shoot, we're trying to get this AWS certification so we can do this. So we and trying to figure out how to lift and shift and it's like This is a mess right now. I know it's 2024. It's gotten better at this. But some of the stuff we did back then is still sitting there, right? It needs to be reviewed. You need to make sure that you have somebody who understands how to configure your file working on it. Okay. Um and I know as a developer you probably don't get to pick, who does that? But you can have some input and you definitely can go look around and see if if you see any problems. If you don't have repeatable, automated hardening process. Again automation is our friend and if we can set all of these servers up the same way, if this is automated, we may spin them up and they're already the same way instead of Joe did it this way and suited it that way. And darling did this one. And who did that one? We don't know. They left the company two years ago and what in the world were they doing? All right, we need to have those some uniformity We need to have them partyed properly and then if you don't use security headers, My thing here is I'm going to say they're a great idea. I would much rather you Um, didn't use them, then use them properly. So, a lot of times we don't set our security headers up correctly, and that again, is that false sense of security? But it's worth looking into. Sometimes, you'll have to do that for compliance things, you'll be required to have security happens. All right, inventory management. Last one. This is going to be that we just don't know what we've got. So um, we have blind spots around all of this. We uh Don't have business approval, or justification for the things we're doing. And we don't see the fact of it, we don't have any kind of inventory and we don't have any visibility on the data that we're sharing especially sensitive data. Uh we don't have good documentation where things run, who has access to it, versioning strategies around them right. We uh Don't have any documentation or our documentation. It's so old, it's useless. It's like, oh yeah, we don't do any of that anymore. And nobody's taken the time to update that documentation. And same with inventory data. Now I will say here that there are some security tools that are getting to the point where they can help you with an API inventory, and even some of your sensitive data. But they have to be implemented correctly and configured correctly. So there's still challenges there. And prevention. Here automation, automation is your friend if you can help. In your automation, to update inventory. That's a great. That's a great idea. Uh, security tooling, again it's coming. I don't think it's quite there yet, inventory. Documentation know your sensitive data flows. So, this is really important why we're sorry where I work because um We had to do assessments for compliance on our sensitive data flows. So we have to know what those are. I maintain a list of those but am I always 100 sure, it's accurate. I hope so. I hope everything. The engineering teams have told me is right, because that's what I'm amazing enough of. Uh, be careful with data and non-print environments. If you like leak sensitive data into non-prod, then it can, we don't usually Care for it. Like we do in production environments, it can be a problem and an attacker can access it there and then versioning I think we struggle with versioning with apis. So you need to have a intentional strategy on your versioning and follow it. Okay. So we made it through the 10. And we actually have six minutes left. All right, so next steps, how do you use this? Um, first of all, talk to your security team, I hope for past the days, I don't know how it is, where you work, where the security people are mean and they're gonna yell at me. My my I don't want to be mean and I don't want to yell at you. I'm going to work with you. I'm your partner partner and I'm your Advocate talk to your security people say, hey can you help me do a threat model on this? Hey can you review this for me? Um and your security people should be coming to you especially on some of those things. Like I was talking where you might be processing processing, sensitive data. Assess your risk. Again, that's going to be with the help of maybe some of your security team or if you have a risk management team, but talk to them about your risk. Um, and then prioritize your security work. Again, that's gonna be based on your risk, right? So, uh, We're going to want to hit the stuff. That's the highest risk first. Not about the easy stuff so you may have something that's maybe middle on the road but it's super easy to fix. Go fix it. Plenty of people get hit on a. Uh, severity, vulnerability. You can get popped on a low severity. Bomber like, so if it's something easy to fix, fix it, no matter what the severity is. And then I like to say Tapas for the hard stuff, Small bites. A little bit at a time. Chip away at it, right? And we'll get there. Educate yourself in others which is what you're doing today, right? Um, so I appreciate you coming to this top. Not everybody wants to talk about security at 8, 30 in the morning, but it's it's important. It's an important part of your job and I think it's only going to get more important. Um, and then talk at a conference, talk to your team, talk at an internal, we do a security Community Practice and I love it when developers come to me and say, hey, can I talk about this thing? We're doing? Yeah, let's go. I love that. And then join the abstract conversation. We need appsite professionals and I would tell you, it's just my opinion, the best apps that people came out of development. Network people make great security Engineers, but they do not make the best appsec Engineers, appsec, Engineers need to understand developers and what developers deal with. So if this stuff interests, you, maybe go talk to your security team about being a security Champion, maybe you don't have Security Champions at your office, talk to your security team about starting them say I'll be your first one, right? Um, Join the upset conversation. There's a lot of good resources out there an apps that a lot of good reading. Okay. Okay, one more chance questions.

Speaker 2   57:33
Yeah. Mentioned a couple times at the security tools today, or maybe by any real little picture. Is there a feature? So it was a feature that you think is missing or something. You like I think the hardest part today is the implementation

Speaker 1   57:47
Of that because we all have done things a little differently and how we handle these guys, right? Yeah, gateways are a little different, our cloud configurations are a little different. This is what we needed to do. This is how we need to scale, you know, those kinds of things and Challenge for them because they have to figure out how to implement their tools. And all of those different scenarios. And I, I just haven't seen them be really successful before that. Yet, the tool itself gives you some great inventory data, you know, is looking at data, loads to see where your sense, those kind of things are great, but it's, it's really the implementation. I think that is the, the big hurdle that they need to get over. Okay. I do have a couple pages at the end of my slides of resources that I used for this presentations. Oh, well, some resources

Speaker 2   58:47
That I think are awesome.

Speaker 1   58:49
Um, These slides, I gave them and I lost her name. Shoot. I gave them to the wonderful person who said she would post them on the code match site under the presentation. So these slides, they're not available yet, but they should be soon on that page, okay? Uh, you can reach out to me on Discord, if you would like me to send you a copy that way too, I'm happy to do that. All right. Thank you guys so much. Appreciate your time.

```